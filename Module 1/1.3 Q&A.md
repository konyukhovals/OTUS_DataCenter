
1. Линки между Spine - как правило нет

2. Стадии фабрики

![image](https://github.com/user-attachments/assets/f92e00ce-0ad1-47b9-9ab0-05e8cc1ad21a)

![image](https://github.com/user-attachments/assets/1961cd1e-fdeb-4bd6-b364-e815766234f5)

3. Склько маршрутов в ECMP?
Максимальное количество маршрутов в ECMP-группе зависит прежде всего от платформы (ASIC) и её прошивки/ОС. Наиболее часто в сетях CLOS и вообще в дата-центрах встречается поддержка от 16 до 64 путей в одной ECMP-группе.

4. MLAG у разных вендоров может называться DFS, VPC

5. VPLS (Virtual Private LAN Service) — это технология, позволяющая организовать единую «виртуальную коммутируемую сеть» (по сути, «виртуальный LAN») поверх операторской (провайдерской) MPLS-сети. Проще говоря, VPLS даёт возможность разбросанным по разным площадкам/городам клиентским узлам находиться в одной широковещательной домене (однотипно VLAN), будто они подключены к одному коммутатору.
Основные принципы:
* Использование MPLS на магистрали провайдера
* * Между PE (Provider Edge) маршрутизаторами строится MPLS-сеть. Для клиентов создаются виртуальные тоннели (LSP) и сессии для эмуляции «Ethernet-переключения».
* Ethernet-пакеты инкапсулируются в MPLS
* *  Фактически каждый PE действует как виртуальный коммутатор: принимает Ethernet-кадры от клиента, присваивает им метки MPLS и отправляет по магистрали провайдера. На выходе их «разворачивают» обратно в исходные кадры.
* Расширение «широковещательного домена»
* * VPLS обеспечивает поддержку широковещательной, мультикастовой и юникастовой доставки кадров: все узлы в одном VPLS «видят» друг друга, как в обычном локальном VLAN.
* Обучение (learning) MAC-адресов
* * PE-устройства запоминают (learn) MAC-адрес клиента и соответствующий MPLS-туннель. Это нужно для эмуляции работы L2-свитча — кадры впоследствии перенаправляются целевому MAC по уже известному пути.

Для чего используют VPLS

* Организация «сквозного» корпоративного VLAN между удалёнными офисами/ЦОД**
* * Когда нужно соединить сети на L2 (например, для каких-то старых сервисов или кластерных приложений, завязанных на широковещании).
* Простое расширение L2-сегментов
* * Можно настроить «виртуальную» L2-сеть поверх MPLS, не меняя радикально сетевой дизайн на стороне клиента.

Альтернативы

* EVPN (Ethernet VPN) поверх MPLS
* * Более современный и масштабируемый аналог, где BGP используется для распространения MAC-адресов и другой служебной информации, а MPLS или VXLAN — в качестве транспортной инкапсуляции.
* Pseudowire (Martini L2VPN, AToM)
* * Тоже создаёт «point-to-point» L2-соединение (pseudowire) между двумя точками. Но VPLS — это, грубо говоря, «многоточечное» решение (multi-point), объединяющее больше двух узлов в один общий широковещательный домен.

Ключевые особенности:

* Широковещательные домены: все подключённые сайты получают широковещательные и мультикастовые кадры. Это удобно, если приложения/протоколы требуют L2.
* Масштабирование: управление большим количеством VPLS-доменов может усложняться при росте числа клиентов и MAC-адресов. Поэтому всё чаще переходят на EVPN (более эффективные механизмы обмена MAC/IP).

Итого, VPLS — это технология L2VPN поверх MPLS-сети, позволяющая «протянуть» виртуальную Ethernet-среду (с поддержкой широковещания) между географически распределёнными площадками.

6. FIB на ASIC


FIB (Forwarding Information Base) на ASIC — это аппаратно-программный механизм в сетевом оборудовании (коммутаторах, маршрутизаторах), при котором таблица маршрутизации (точнее, данные для «быстрой» маршрутизации/коммутации) хранится и обрабатывается непосредственно в специализированных чипах (ASIC), а не только в ПО (CPU).

### Разделение RIB и FIB

* RIB (Routing Information Base):
* * Логическая база, которую формирует контрол-план (control plane) — сюда пишут маршруты динамические протоколы (BGP, OSPF, ISIS и др.), статические маршруты, политика маршрутизации и т.д.
* * Хранится обычно в памяти CPU (или внутренней базе данных ОС устройства).
* * Может содержать очень много маршрутов, часть из которых не обязательно участвуют в реальном форвардинге (например, запасные, невыбранные по административным весам).

* FIB (Forwarding Information Base):
* * Это таблица «наилучших» (выбранных) путей, которая используется непосредственно при форвардинге пакетов в data plane.
* * Формируется на основе RIB, но содержит только активные/эффективные маршруты.
* * Обновляется, когда в RIB что-то меняется (новые маршруты, изменение Next-hop и т.д.).

### Хранение FIB в ASIC

* Аппаратные ресурсы (TCAM, SRAM, CAM)
* * В высокоскоростных коммутаторах/маршрутизаторах FIB часто хранится в TCAM (Ternary Content Addressable Memory) или «комбинации» TCAM + SRAM.
* * TCAM хорошо подходит для поиска по маске/префиксу (Longest Prefix Match), что нужно при IP-маршрутизации.
* * Вместе с записью о префиксе хранится Next-hop (куда слать пакет), VLAN, метка MPLS, политика QoS и т.д.

* Ограниченный объём
* * TCAM — дорогое и «ёмкостно ограниченное» ресурс. Поэтому устройства имеют чётко ограниченную максимальную вместимость маршрутов или ACL-записей.
* * На некоторых платформах возможно гибко конфигурировать профили TCAM (разделять память под IPv4, IPv6, ACL, QoS).

* Линейная скорость (line rate)
* * За счёт поиска в ASIC на основе TCAM/SRAM устройство способно маршрутизировать или коммутировать пакеты на скорости портов (line rate), не нагружая CPU.
* * CPU (control plane) участвует только в обработке «проброшенных» в него пакетов (например, протоколы маршрутизации, исключительные случаи и т.п.).

### Обновление FIB

* Протоколы маршрутизации (BGP, OSPF, ISIS и т.д.) или настройки статических маршрутов «записываются» в RIB.
* OS/ПО сетевого устройства выбирает наилучшие (best) маршруты для каждого префикса.
* Эти «best routes» программно отправляются в FIB ASIC’а, где формируется «таблица быстрого форвардинга».
* При изменениях (новые маршруты, протокол пересчитал пути и т.д.) FIB обновляется «поштучно» или батчами.

### Аппаратные ограничения и оптимизация

* Максимальное количество маршрутов
* * Каждая модель чипа (ASIC) имеет спецификацию: сколько IP-префиксов (IPv4/IPv6) он может хранить. Например, 128K IPv4 и 64K IPv6, или 1M маршрутов в топовых моделях.
* * Если RIB в результате «раздувается» до более чем ASIC может вместить, обычно происходит «over-subscription» (часть маршрутов не попадает в FIB) либо ASIC переходит в «кэширующий» режим (либо просто не добавляет новые маршруты).
* Профили TCAM (SDM profiles)
* * Некоторые ОС (Cisco IOS-XE, NX-OS, JunOS, EOS и др.) позволяют администратору «подкручивать» распределение памяти ASIC (например, больше выделить под IPv6, меньше под IPv4).

### Выгода аппаратной FIB

* Высокая скорость (line rate) и низкая задержка.
* Разгрузка CPU – CPU не обрабатывает пакет за пакетом, а только управляет таблицами.
* Стабильная производительность: ASIC-движок обрабатывает потоки на постоянной скорости, без деградации при росте нагрузки.

Таким образом, FIB на ASIC — это «рабочая» таблица маршрутизации/коммутации в аппаратной памяти (TCAM/SRAM), благодаря которой современное сетевое оборудование способно с высокой скоростью и эффективностью перенаправлять пакеты, опираясь на данные, сформированные контрол-планом (RIB).
